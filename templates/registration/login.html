{% extends "base.html" %}
{% load static %}

{% block content %}
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap');

        :root{
            --hue:255;
            --bg-1:hsl(var(--hue) 60% 98%);
            --bg-2:hsl(calc(var(--hue)+60) 100% 96%);
            --card-bg:hsla(0 0% 100%/.58);
            --card-border:hsla(0 0% 100%/.35);
            --text-1:#1e193c;
            --primary:#5b4bff;
            --primary-dark:#3b2dff;
            --field-bg:hsla(0 0% 100%/.88);
            --error-bg:#ffe5e5;
            --error-text:#c30000;
        }

        /* ——— фон + лёгкий ореол цвета ——— */
        html,body{height:100%;margin:0;font-family:"Poppins",sans-serif;color:var(--text-1);background:linear-gradient(160deg,var(--bg-1) 0%,var(--bg-2) 100%);overflow:hidden;}
        .halo{position:fixed;inset:0;z-index:0;pointer-events:none;background:radial-gradient(circle at 80% 20%,rgba(255,94,178,.35) 0%,transparent 45%),radial-gradient(circle at 20% 80%,rgba(0,204,255,.35) 0%,transparent 45%);filter:blur(90px);transform:scale(1.2);}
        #particles{position:fixed;inset:0;z-index:0;}

        /* ——— центр + карточка ——— */
        .wrapper{position:relative;z-index:1;min-height:100%;display:flex;align-items:center;justify-content:center;padding:2rem;perspective:1200px;}
        .card{width:100%;max-width:460px;background:var(--card-bg);border:1px solid var(--card-border);border-radius:28px;padding:64px 56px 52px;backdrop-filter:blur(32px) saturate(160%);-webkit-backdrop-filter:blur(32px) saturate(160%);box-shadow:0 28px 60px rgba(0,0,0,.15);transform-style:preserve-3d;transition:transform .35s cubic-bezier(.03,.98,.52,.99);}
        .card::before{content:'';position:absolute;inset:-2px;border-radius:inherit;background:linear-gradient(135deg,#ff7ab6 0%,#7a5bff 45%,#4b5bff 55%,#29d4ff 100%);z-index:-1;-webkit-mask:linear-gradient(#fff 0 0) content-box,linear-gradient(#fff 0 0);-webkit-mask-composite:xor;mask-composite:exclude;}

        h1.title{margin:0 0 2.4rem;font-size:2.6rem;font-weight:700;text-align:center;letter-spacing:-.02em;}

        /* ——— форма ——— */
        .login-form{display:flex;flex-direction:column;gap:1.6rem;}
        .field{position:relative;}
        .field svg{position:absolute;left:22px;top:50%;transform:translateY(-50%);width:22px;height:22px;fill:var(--primary);opacity:.9;}

        /*  FIX: высота, line-height и симметричные паддинги — текст ровно по центру  */
        .field input{
            width:100%;box-sizing:border-box;
            height:64px;                       /* фикс. высота поля */
            padding:0 22px 0 64px;             /* одинаково сверху и снизу */
            line-height:64px;                  /* = высоте, → идеальный центр */
            font-size:16px;font-weight:500;
            border:none;border-radius:18px;
            background:var(--field-bg);
            box-shadow:inset 0 0 0 2px rgba(0,0,0,.04);
            transition:box-shadow .3s,background .3s;
        }
        .field input:focus{outline:none;background:#fff;box-shadow:inset 0 0 0 3px var(--primary);}
        .field input::placeholder{color:transparent;}

        /* плавающий label */
        .field label{
            position:absolute;left:64px;top:50%;transform:translateY(-50%);
            pointer-events:none;font-size:16px;font-weight:500;opacity:.6;transition:all .25s;
        }
        .field input:focus+label,
        .field input:not(:placeholder-shown)+label{top:10px;transform:none;font-size:12px;opacity:.9;}

        /* ошибки */
        .errorlist{margin:0;padding:14px 18px;list-style:none;font-size:14px;border-radius:14px;background:var(--error-bg);color:var(--error-text);}

        /* кнопка */
        .btn{position:relative;overflow:hidden;width:100%;padding:18px;border:none;border-radius:999px;font-size:16px;font-weight:600;letter-spacing:.05em;color:#fff;background:linear-gradient(135deg,var(--primary) 0%,var(--primary-dark) 100%);cursor:pointer;transition:transform .2s,box-shadow .25s;}
        .btn:hover{transform:translateY(-4px);box-shadow:0 14px 28px rgba(0,0,0,.25);}
        .btn:active{transform:translateY(0);box-shadow:0 8px 16px rgba(0,0,0,.25);}
        .btn::after{content:'';position:absolute;inset:0;border-radius:inherit;background:rgba(255,255,255,.35);opacity:0;transform:scale(0);transition:opacity .6s,transform .6s;}
        .btn:active::after{opacity:1;transform:scale(2);transition:0s;}

        @media(max-width:500px){.card{padding:52px 34px 46px;}h1.title{font-size:2.2rem;}}
    </style>

    <div class="halo"></div>
    <canvas id="particles"></canvas>

    <div class="wrapper">
        <div class="card" data-tilt>
            <h1 class="title">Вход в Malva Booking</h1>

            <form method="post" class="login-form">
                {% csrf_token %}
                {{ form.non_field_errors }}

                <div class="field">
                    {{ form.username }}
                    <label for="{{ form.username.id_for_label }}">Username</label>
                    <svg viewBox="0 0 24 24"><path d="M12 12c2.761 0 5-2.239 5-5S14.761 2 12 2 7 4.239 7 7s2.239 5 5 5zm0 2c-3.859 0-7 3.141-7 7 0 .552.448 1 1 1h12c.552 0 1-.448 1-1 0-3.859-3.141-7-7-7z"/></svg>
                </div>

                <div class="field">
                    {{ form.password }}
                    <label for="{{ form.password.id_for_label }}">Password</label>
                    <svg viewBox="0 0 24 24"><path d="M17 9h-1V6a4 4 0 00-8 0v3H7a2 2 0 00-2 2v9a2 2 0 002 2h10a2 2 0 002-2v-9a2 2 0 00-2-2zm-6 7.73V18a1 1 0 002 0v-1.27a2 2 0 10-2 0zM9 6a3 3 0 016 0v3H9V6z"/></svg>
                </div>

                <button type="submit" class="btn">Войти</button>
            </form>
        </div>
    </div>

    <script>
        /* particles */
        (function(){
            const c=document.getElementById('particles'),ctx=c.getContext('2d'),dpr=window.devicePixelRatio||1;
            let w,h,parts=[];const opt={amt:120,size:2,speed:.4,line:140};
            function resize(){w=c.width=window.innerWidth*dpr;h=c.height=window.innerHeight*dpr;c.style.width=window.innerWidth+'px';c.style.height=window.innerHeight+'px';}
            window.addEventListener('resize',resize);resize();
            function init(){parts=[];for(let i=0;i<opt.amt;i++)parts.push({x:Math.random()*w,y:Math.random()*h,vx:(Math.random()-.5)*opt.speed*dpr,vy:(Math.random()-.5)*opt.speed*dpr});}
            init();
            (function tick(){
                ctx.clearRect(0,0,w,h);
                for(const p of parts){p.x+=p.vx;p.y+=p.vy;if(p.x<0||p.x>w)p.vx*=-1;if(p.y<0||p.y>h)p.vy*=-1;ctx.beginPath();ctx.arc(p.x,p.y,opt.size*dpr,0,Math.PI*2);ctx.fillStyle='rgba(255,255,255,.8)';ctx.fill();}
                for(let i=0;i<parts.length;i++)for(let j=i+1;j<parts.length;j++){const p=parts[i],q=parts[j],dx=p.x-q.x,dy=p.y-q.y,d=Math.hypot(dx,dy);if(d<opt.line*dpr){ctx.strokeStyle='rgba(255,255,255,'+(1-d/(opt.line*dpr))+')';ctx.lineWidth=1*dpr;ctx.beginPath();ctx.moveTo(p.x,p.y);ctx.lineTo(q.x,q.y);ctx.stroke();}}
                requestAnimationFrame(tick);
            })();
        })();

        /* 3-D tilt */
        (function(){
            const card=document.querySelector('.card[data-tilt]'),d=20;
            card.addEventListener('mousemove',e=>{const r=card.getBoundingClientRect(),x=e.clientX-r.left-r.width/2,y=e.clientY-r.top-r.height/2;card.style.transform=`rotateX(${(-y/d)}deg) rotateY(${(x/d)}deg)`;});
            card.addEventListener('mouseleave',()=>card.style.transform='rotateX(0) rotateY(0)');
        })();
    </script>
{% endblock %}
