{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>{{ merch_copy.page_title }}</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  {% with meta_title=merch_copy.meta_title meta_description=merch_copy.meta_description meta_section="merch" %}
    {% include "includes/marketing_head.html" %}
  {% endwith %}

  <!-- Preload custom fonts -->
  {% if font_settings and font_settings.preload_fonts %}
    {% for font in font_settings.preload_fonts %}
      <link rel="preload" href="{{ font.url }}" as="font" type="{{ font.mime_type|default:'font/ttf' }}" crossorigin>
    {% endfor %}
  {% else %}
    <link rel="preload" href="{% static 'fonts/Diesel.ttf' %}" as="font" type="font/ttf" crossorigin>
    <link rel="preload" href="{% static 'fonts/Inter-Variable.ttf' %}" as="font" type="font/ttf" crossorigin>
  {% endif %}

  <style>
    /* ========================== VARIABLES & FONTS ========================== */
    :root{
      --bg:#000000; --fg:#FFFFFF; --muted:rgba(255,255,255,.72); --muted-2:rgba(255,255,255,.55);
      --line:rgba(255,255,255,.12); --panel:#0E0E0E; --panel-2:#131313;
      --accent:#d50000; --accent-2:#ff1a1a; --ok:#17d45b;
      --radius-lg:1.25rem; --radius-sm:.6rem; --shadow:0 10px 30px rgba(0,0,0,.45);
      --container:clamp(320px, 92vw, 1280px);
      --site-header-height:72px;
      --site-header-toggle-size:46px;

      --font-body:"Inter", ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif;
      --font-head:"Diesel",  ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif;
    }

    {% if font_settings %}
      {% for font in font_settings.fonts %}
        {% if font.has_source %}
    @font-face{
      font-family:"{{ font.family }}";
      src:url("{{ font.url }}") format("{{ font.format|default:'truetype' }}");
      font-weight:{{ font.weight|default:"400" }};
      font-style:{{ font.style|default:"normal" }};
      font-display:{{ font.display|default:"swap" }};
    }
        {% endif %}
      {% endfor %}
      {% with body_stack=font_settings.body.stack|default:'"Inter", ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif' %}
      {% with heading_stack=font_settings.heading.stack|default:'"Diesel", ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif' %}
      {% with ui_stack=font_settings.ui.stack|default:body_stack %}
    :root{
      --font-body: {{ body_stack|safe }};
      --font-head: {{ heading_stack|safe }};
      --font-ui:   {{ ui_stack|safe }};
    }
      {% endwith %}
      {% endwith %}
      {% endwith %}
    {% else %}
    @font-face{
      font-family:"Diesel";
      src:url("{% static 'fonts/Diesel.ttf' %}") format("truetype");
      font-weight:100 900; font-style:normal; font-display:swap;
    }
    {% endif %}

    /* ============================== BASE RESET ============================= */
    *,*::before,*::after{ box-sizing:border-box; margin:0; padding:0; }
    html{ text-rendering:optimizeLegibility; -webkit-font-smoothing:antialiased; }
    body{ background:var(--bg); color:var(--fg); font-family:var(--font-body); }
    a{ color:inherit; text-decoration:none; }
    img{ max-width:100%; height:auto; display:block; }

    /* ============================== UTILITIES ============================== */
    .container{ width:var(--container); margin-inline:auto; padding-inline:1rem; }
    .visually-hidden{ position:absolute!important; height:1px; width:1px; overflow:hidden; clip:rect(1px,1px,1px,1px); white-space:nowrap; }

    .btn{
      display:inline-flex; align-items:center; gap:.6em;
      padding:.78rem 1.15rem; border-radius:var(--radius-sm);
      font-weight:800; border:1px solid transparent; cursor:pointer; transition:.2s;
      font-family:var(--font-body);
    }
    .btn--primary{ background:var(--accent); color:#fff; }
    .btn--primary:hover{ transform:translateY(-2px); box-shadow:0 12px 22px rgba(213,0,0,.25); }
    .btn--ghost{ background:transparent; border-color:var(--line); color:var(--fg); }
    .btn--ghost:hover{ border-color:var(--accent); color:var(--accent); }
    .btn-row{ display:flex; gap:.6rem; margin-top:1.2rem; flex-wrap:wrap; }

    .badge{ display:inline-block; font-size:.78rem; padding:.15rem .55rem; border-radius:999px; background:var(--accent); color:#fff; }

    /* ============================== TYPOGRAPHY ============================= */
    h1,h2,h3,h4,h5,h6,
    .title,.section__title{font-family:var(--font-head);}
    .brand,.brand__word{font-family:var(--topbar-brand-font, var(--font-head));}
    nav a,.btn,.badge{font-family:var(--topbar-nav-font, var(--font-head));}

    /* ============================== HEADER ================================ */
    .site-header{
      position:sticky; top:0; z-index:1000;
      background:#000; border-bottom:1px solid var(--line);
      /* no blur on header for clarity + performance */
    }
    .site-header__inner{
      display:flex; align-items:center; justify-content:space-between;
      gap:1.25rem; padding:.7rem 0;
    }

    /* Brand cluster (header-specific override keeps footer logo intact) */
    .brand{
      display:flex; align-items:baseline; gap:.9rem; min-width:max-content;
      font-weight:var(--topbar-brand-weight, 900);
      letter-spacing:var(--topbar-brand-letter-spacing, .06em);
    }
    .brand__logo{ width:34px; height:34px; border-radius:10px; background:radial-gradient(90% 90% at 30% 30%, var(--accent-2), var(--accent)); box-shadow:0 0 40px -6px var(--accent-2); }
    .site-header .brand__logo{
      all:unset; display:inline-flex; gap:.5rem; line-height:1;
      font-weight:var(--topbar-brand-weight, 900);
      letter-spacing:var(--topbar-brand-letter-spacing, .06em);
      font-size:var(--topbar-brand-size, clamp(1.2rem, 1.8vw, 1.55rem));
      text-transform:var(--topbar-brand-transform, uppercase);
      font-family:var(--topbar-brand-font, var(--font-head));
    }
    .brand__word--white{ color:#fff; }
    .brand__word--red{ color:var(--accent); }
    .brand__tagline{
      margin-left:1.1rem; white-space:nowrap; font-size:clamp(.78rem, .95vw, .95rem);
      font-weight:900; letter-spacing:.12em; color:rgba(255,255,255,.78);
      font-family:var(--topbar-nav-font, var(--font-body));
      text-transform:uppercase;
    }

    /* Inline nav */
    nav ul{ display:flex; align-items:center; gap:1.4rem; list-style:none; }
    nav a{
      line-height:1; font-weight:700; letter-spacing:.02em;
      font-size:var(--topbar-nav-size-desktop, .9rem); text-transform:none;
      color:rgba(255,255,255,.92);
      font-family:var(--topbar-nav-font, var(--font-head));
    }
    nav a:hover, nav a[aria-current="page"]{ color:#fff; }
    /* Make button-looking links in nav look like text */
    nav .btn, nav .btn--ghost{ padding:0; border:0; background:none; }

    /* Mobile toggle */
    .site-header__toggle{
      display:none; align-items:center; justify-content:center;
      width:var(--site-header-toggle-size); height:var(--site-header-toggle-size);
      border-radius:.85rem; border:1px solid rgba(255,255,255,.16);
      background:rgba(255,255,255,.06); color:#fff; cursor:pointer; transition:transform .18s, background .18s, border-color .18s;
    }
    .site-header__toggle:hover{ background:rgba(255,255,255,.12); border-color:rgba(255,255,255,.28); }
    .site-header__toggle:focus-visible{ outline:2px solid #fff; outline-offset:3px; }
    .site-header__toggle-box{ position:relative; width:20px; height:14px; display:block; }
    .site-header__toggle-lines,
    .site-header__toggle-lines::before,
    .site-header__toggle-lines::after{
      content:""; position:absolute; left:0; width:100%; height:2px; border-radius:999px; background:currentColor; transition:transform .22s, opacity .22s, background .22s;
    }
    .site-header__toggle-lines{ top:50%; transform:translateY(-50%); }
    .site-header__toggle-lines::before{ top:-6px; }
    .site-header__toggle-lines::after{ top:6px; }
    .site-header--open .site-header__toggle{ background:rgba(255,255,255,.16); border-color:rgba(255,255,255,.38); }
    .site-header--open .site-header__toggle-lines{ background:transparent; }
    .site-header--open .site-header__toggle-lines::before{ transform:translateY(6px) rotate(45deg); }
    .site-header--open .site-header__toggle-lines::after{ transform:translateY(-6px) rotate(-45deg); }

    /* Mobile nav overlay */
    @media (max-width:960px){
      body.nav-open{ overflow:hidden; }
      .site-header{ --site-header-height:max(62px, 10vh); }
      .site-header .container{ padding-inline:clamp(16px, 4vw, 24px); }
      .site-header__inner{ display:grid; grid-template-columns:auto max-content; align-items:center; gap:clamp(12px, 3vw, 24px); }
      .site-header__toggle{ display:inline-flex; }
      nav{
        position:fixed; inset:0; padding-top:calc(var(--site-header-height) + 1rem);
        padding-inline:clamp(20px, 6vw, 36px); padding-bottom:clamp(28px, 12vh, 46px);
        background:rgba(5,5,5,.88); backdrop-filter:blur(18px) saturate(1.2);
        display:flex; align-items:flex-start; opacity:0; pointer-events:none; transform:translateY(-12px);
        transition:opacity .22s ease, transform .22s ease; z-index:900;
      }
      nav ul{ flex-direction:column; align-items:stretch; gap:.45rem; width:100%; }
      nav li{ width:100%; }
      nav a, nav .btn, nav .btn--ghost{
        width:100%; justify-content:space-between; background:rgba(255,255,255,.04);
        border:1px solid rgba(255,255,255,.08); border-radius:.85rem; padding:.95rem 1rem; font-size:1.05rem; letter-spacing:.035em;
      }
      nav a:hover, nav a[aria-current="page"], nav .btn:hover{
        background:rgba(255,255,255,.1); border-color:rgba(255,255,255,.22); color:#fff;
      }
      .site-header--open nav{ opacity:1; pointer-events:auto; transform:translateY(0); }
      .brand__tagline{ display:none; }
    }
    @media (max-width:1080px){ .brand__tagline{ display:none; } }

    /* ================================ HERO ================================= */
    .hero{
      /* Transparent so the smoke layer is visible behind content */
      background:transparent;
    }
    .hero__inner{
      display:grid; grid-template-columns:1.1fr .9fr; align-items:center; gap:1.2rem;
      padding:clamp(2rem,6vw,4.5rem) 0;
    }
    .kicker{ color:var(--muted-2); font-weight:800; letter-spacing:.18em; text-transform:uppercase; font-size:.78rem; }
    .title{ font-size:clamp(2rem,4.6vw,3.4rem); font-weight:900; }
    .lead{ color:var(--muted); font-size:clamp(1rem,1.5vw,1.15rem); max-width:54ch; margin-top:1rem; }

    .frame{ border-radius:1.2rem; border:1px solid var(--line);
      background:linear-gradient(180deg,#0b0b0b,#0a0a0a);
      box-shadow:inset 0 0 0 1px rgba(255,255,255,.02), 0 14px 28px rgba(0,0,0,.45);
      aspect-ratio:16/10; display:flex; align-items:center; justify-content:center; color:var(--muted-2);
    }

    .hero__media{ justify-self:start; max-width:min(52vw, 720px); position:relative; }
    .hero__media img{
      width:100%; aspect-ratio:16/9; max-height:clamp(220px, 42vh, 420px);
      object-fit:cover; border-radius:1rem;
    }
    .hero__disclaimer{
      position:absolute; left:1.1rem; bottom:1.1rem; padding:.35rem .9rem; border-radius:.85rem;
      border:1px solid rgba(255,255,255,.18); background:rgba(0,0,0,.6); color:rgba(255,255,255,.8);
      font-size:.72rem; letter-spacing:.12em; text-transform:uppercase; display:inline-flex; align-items:center; gap:.45rem; backdrop-filter:blur(6px);
    }
    .hero__disclaimer::before{ content:""; width:18px; height:1px; background:rgba(255,255,255,.45); flex-shrink:0; }

    @media (max-width:900px){
      .hero__inner{ grid-template-columns:1fr; }
      .hero__media{ max-width:100%; }
      .hero__disclaimer{ position:static; margin-top:.85rem; padding:.4rem .85rem; backdrop-filter:none; }
    }

    /* =============================== SECTIONS ============================== */
    .section{ padding:clamp(2rem,6vw,4rem) 0; border-top:1px solid var(--line); }
    .section__head{ display:flex; align-items:end; justify-content:space-between; gap:1rem; margin-bottom:1.1rem; }
    .section__title{ font-size:1.6rem; font-weight:900; }
    .section__desc{ color:var(--muted-2); }

    .grid{ display:grid; gap:1rem; }
    .grid--cards{ grid-template-columns:repeat(auto-fill, minmax(260px,1fr)); }
    .grid--cards h3{ margin-top:.6rem; }

    .card{
      background:linear-gradient(180deg,var(--panel),var(--panel-2));
      border:1px solid var(--line); border-radius:1rem; padding:1rem; box-shadow:var(--shadow);
    }
    .card__media{
      border-radius:.85rem; overflow:hidden; border:1px solid rgba(255,255,255,.08);
      background:#0c0c0c;
    }
    .card__media img{ width:100%; height:100%; object-fit:cover; aspect-ratio:4/3; }
    .card__body{ display:grid; gap:.45rem; }
    .card__meta{
      margin-top:.6rem; display:grid; gap:.4rem; font-size:.92rem; color:var(--muted-2);
    }
    .card__meta-row{ display:flex; flex-wrap:wrap; gap:.4rem .6rem; align-items:baseline; }
    .card__meta dt{
      font-size:.7rem; letter-spacing:.16em; text-transform:uppercase; color:var(--muted-2);
      font-weight:800;
    }
    .card__meta dd{ margin:0; color:var(--fg); font-weight:700; }

    .coming-soon{
      display:grid; gap:.55rem; margin:1rem 0 1.6rem;
      padding:1rem 1.1rem; border-radius:1rem;
      border:1px solid rgba(213,0,0,.35); background:rgba(213,0,0,.08);
      box-shadow:0 14px 26px rgba(213,0,0,.18);
    }
    .coming-soon__title{ font-family:var(--font-head); font-size:1.25rem; font-weight:900; }
    .section--coming-soon .card{ border-style:dashed; }

    .social{
      margin-top:1.8rem; padding:1.1rem;
      border:1px solid var(--line); border-radius:1rem;
      background:linear-gradient(180deg,#0c0c0c,#111111);
      display:grid; gap:.75rem;
    }
    .social__title{ font-family:var(--font-head); font-weight:900; font-size:1.2rem; }
    .social__links{ display:flex; flex-wrap:wrap; gap:.6rem; }
    .social__link{
      display:inline-flex; align-items:center; gap:.4rem;
      padding:.55rem .95rem; border-radius:999px;
      border:1px solid rgba(255,255,255,.16); color:#fff;
      font-weight:800; letter-spacing:.02em; transition:.2s ease;
      background:rgba(255,255,255,.04);
    }
    .social__link:hover{ border-color:rgba(213,0,0,.6); color:#fff; box-shadow:0 0 18px rgba(213,0,0,.25); }

    /* Skeleton shimmer */
    .sk{ height:140px; border-radius:.8rem; background:linear-gradient(90deg,#111,#151515,#111); background-size:200% 100%; animation:sh 1.1s ease-in-out infinite; }
    @keyframes sh{ 0%{background-position:200% 0} 100%{background-position:-200% 0} }
    @media (prefers-reduced-motion:reduce){ .sk{ animation:none; } }

    /* =============================== FOOTER ================================ */
    .site-footer{ border-top:1px solid var(--line); padding:1.6rem 0; color:var(--muted-2); font-size:.95rem; }
    .site-footer__inner{ display:flex; align-items:center; justify-content:space-between; gap:1rem; flex-wrap:wrap; }

    /* ============================== SMOKE LAYER ============================ */
    #bg{ position:fixed; inset:0; z-index:0; pointer-events:none; }
    #bg canvas{ position:absolute; inset:0; width:100%; height:100%; display:block; }
    /* Content layers above smoke */
    .site-header, .hero, main, .site-footer{ position:relative; z-index:1; }

    /* ============================= CONTACT FAB ============================ */
    :root{ --ink:#eaeaea; --red:var(--accent); --red-dark:#b60000; --contact-font:"Helvetica Neue", Arial, sans-serif; }
    .contact-fab{
      position:fixed; right:22px; bottom:22px; z-index:2100;
      display:inline-flex; align-items:center; gap:.6em;
      padding:.9rem 1.15rem; border-radius:999px;
      border:1px solid rgba(255,255,255,.08);
      background:linear-gradient(180deg,var(--red) 0%,var(--red-dark) 100%);
      color:#fff; font-weight:900; letter-spacing:.02em; line-height:1;
      cursor:pointer; box-shadow:0 12px 26px rgba(213,0,0,.28), 0 0 26px rgba(213,0,0,.18);
      transition:.18s ease; font-family:var(--contact-font); font-style:normal;
    }
    .contact-fab:hover{ transform:translateY(-2px); filter:saturate(1.05); }
    .contact-fab:focus-visible{ outline:2px solid #fff; outline-offset:3px; }
    .contact-fab svg{ width:20px; height:20px; fill:currentColor; opacity:.95; }

    .contact-modal{
      position:fixed; inset:0; z-index:2200; display:none;
      align-items:center; justify-content:center; padding:1rem;
      background:rgba(0,0,0,.65); backdrop-filter:blur(2px);
    }
    .contact-modal[open]{ display:flex; }
    .contact-dialog{
      width:min(560px, 92vw);
      background:linear-gradient(180deg,#0c0c0c,#121212);
      border:1px solid var(--line); border-radius:1rem;
      padding:1.1rem 1.1rem .95rem; color:var(--ink);
      box-shadow:0 18px 44px rgba(0,0,0,.55), 0 0 32px rgba(213,0,0,.18);
      position:relative;
    }
    .contact-title{
      font-family:var(--font-head); font-weight:900; letter-spacing:.005em; line-height:1.15;
      font-size:1.6rem; margin:.2rem 2.2rem 1rem .2rem; color:#fff; text-transform:none;
    }
    .contact-close{
      position:absolute; right:12px; top:10px; width:36px; height:36px;
      border:1px solid var(--line); border-radius:.5rem; background:#0f0f0f;
      color:#bdbdbd; cursor:pointer; font-size:20px; line-height:1;
    }
    .contact-body{ display:grid; gap:.75rem; }
    .contact-row{
      display:flex; align-items:center; justify-content:space-between; gap:.6rem;
      background:rgba(255,255,255,.06); border:1px solid var(--line);
      border-radius:.7rem; padding:.7rem .8rem; font-family:var(--contact-font); font-style:normal;
    }
    .contact-row a{ color:#fff; font-weight:800; text-decoration:none; }
    .contact-sub{ color:rgba(255,255,255,.72); font-size:.95rem; }
    .contact-actions{ display:flex; gap:.6rem; margin-top:.9rem; flex-wrap:wrap; }
    .contact-btn{
      display:inline-flex; align-items:center; gap:.5em; padding:.7rem 1rem; border-radius:.55rem;
      border:1px solid var(--line); background:#0f0f0f; color:#fff; cursor:pointer;
      font-family:var(--contact-font); font-weight:800; font-style:normal;
    }
    .contact-btn:hover{ border-color:rgba(213,0,0,.45); box-shadow:0 0 16px rgba(213,0,0,.25); }

    /* Hide FAB if required by adding .no-contact-fab on body */
    body.no-contact-fab .contact-fab{ display:none !important; }

    @media (max-width:640px){
      .contact-fab{ right:14px; bottom:14px; }
      .contact-title{ font-size:1.45rem; }
    }
  </style>
  <style>
/* === HOTFIX: mobile menu layering + header typography ================== */

/* 1) Хедер и меню всегда поверх контента и FAB */
.site-header{ z-index: 3200; } /* выше контента и дыма */
@media (max-width:960px){
  .site-header nav{
    z-index: 3300;                 /* выше FAB */
    overflow-y: auto;              /* скролл длинного меню */
    -webkit-overflow-scrolling: touch;
  }
}

/* 2) Открытие меню работает и при .site-header--open, и при body.nav-open */
.site-header--open nav,
body.nav-open nav{
  opacity: 1;
  pointer-events: auto;
  transform: translateY(0);
}

/* Прячем FAB в любом состоянии открытого меню */
body.nav-open .contact-fab,
.site-header--open ~ .contact-fab{
  display: none !important;
}

/* 3) Хедер */
.site-header .brand,
.site-header .brand__logo,
.site-header .brand__word{
  font-family: var(--topbar-brand-font, var(--font-body)) !important;
  font-style: normal !important;
  text-transform: var(--topbar-brand-transform, uppercase);
  letter-spacing: var(--topbar-brand-letter-spacing, .08em);
  font-weight: var(--topbar-brand-weight, 800);
}
.site-header .brand__tagline,
.site-header nav a,
.site-header nav .btn,
.site-header nav .btn--ghost{
  font-family: var(--topbar-nav-font, var(--font-body)) !important;
  font-style: normal !important;
}

/* 4) Аккуратные фокусы на iOS, без «огромных синих рамок» */
.site-header nav a:focus{ outline: none; }
.site-header nav a:focus-visible{
  outline: 2px solid rgba(255,255,255,.6);
  outline-offset: 3px;
  border-color: rgba(255,255,255,.22);
}

/* ==== Mobile: add spacing between nav buttons ==== */
@media (max-width: 960px){
  .site-header nav ul{
    gap: .9rem !important;                 /* было ~.45rem */
  }
  .site-header nav a,
  .site-header nav .btn,
  .site-header nav .btn--ghost{
    padding: 1.05rem 1.15rem !important;   /* чуть больше hit‑area */
  }
}

/* ==== Mobile: move disclaimer below image, keep 1 line ==== */
@media (max-width: 900px){
  /* убираем flex/фикс‑ratio у рамки медиа, чтобы текст лег под картинку */
  .hero__media.frame{
    display: block !important;
    aspect-ratio: auto !important;
  }
  .hero__disclaimer{
    position: static !important;           /* под картинкой */
    display: inline-flex !important;
    margin-top: .6rem !important;
    white-space: nowrap !important;        /* одна строка */
    max-width: 100% !important;
    overflow: hidden !important;
    text-overflow: ellipsis !important;    /* если вдруг не влезет */
    letter-spacing: .08em !important;      /* чуть компактнее для узких экранов */
    font-size: .7rem !important;
    -webkit-backdrop-filter: none !important;
    backdrop-filter: none !important;
  }
}
/* ===== Mobile nav: more spacing, equal width, nicer rhythm ===== */
@media (max-width: 960px){
  /* Stack items with generous vertical rhythm */
  .site-header nav ul{
    gap: 1.1rem !important;                 /* larger space between items */
    width: 100%;
    padding-block: .25rem;
  }

  /* Fallback for older iOS Safari where flex gap can be flaky */
  @supports not (gap: 1rem){
    .site-header nav li{ margin-bottom: 1.1rem !important; }
    .site-header nav li:last-child{ margin-bottom: 0 !important; }
  }

  .site-header nav li{ width: 100%; }

  .site-header nav a,
  .site-header nav .btn,
  .site-header nav .btn--ghost{
    width: 100% !important;
    display: flex !important;
    align-items: center;
    justify-content: space-between;
    padding: 1.15rem 1.2rem !important;     /* bigger hit area */
    min-height: 56px;                       /* comfortable touch target */
    border-radius: 1rem !important;
    background: rgba(255,255,255,.05) !important;
    border: 1px solid rgba(255,255,255,.12) !important;
    box-shadow: 0 8px 24px rgba(0,0,0,.35); /* subtle lift */
  }

  /* Keep the "Soon" badge tidy inside the pill */
  .site-header nav a .badge{
    margin-left: .6rem;
    vertical-align: middle;
  }
}

</style>

</head>

<body>
  {% include "includes/marketing_body.html" %}

  <!-- Smoke layer -->
  <div id="bg"></div>

  <a href="#main" class="visually-hidden">{{ merch_copy.skip_to_main_label }}</a>

  {% with current='merch' header_copy=merch_copy %}
    {% include "includes/topbar_client_v3.html" %}
  {% endwith %}

  <section class="hero">
    <div class="container hero__inner">
      <div class="hero__copy">
        <p class="kicker">{{ merch_copy.hero_kicker }}</p>
        <h1 class="title">{{ merch_copy.hero_title }}</h1>
        <p class="lead">{{ merch_copy.hero_lead }}</p>
        <div class="btn-row">
          <a class="btn btn--primary" href="{% url 'home' %}">{{ merch_copy.hero_primary_cta_label }}</a>
          <a class="btn btn--ghost" href="{% url 'client-dashboard' %}">{{ merch_copy.hero_secondary_cta_label }}</a>
        </div>
      </div>

      <div class="hero__media frame frame--media">
        <img src="{{ hero_media.src }}" alt="{{ hero_media.alt|default:'Merch hero' }}" loading="lazy" decoding="async">
        <p class="hero__disclaimer">{{ hero_media.caption|default:merch_copy.hero_disclaimer_fallback }}</p>
      </div>
    </div>
  </section>

  <main id="main">
    <section class="section{% if merch_copy.coming_soon_enabled %} section--coming-soon{% endif %}">
      <div class="container">
        <div class="section__head">
          <div>
            <h2 class="section__title">{{ merch_copy.section_title }}</h2>
            <p class="section__desc">{{ merch_copy.section_desc }}</p>
          </div>
          <span class="badge">{{ merch_copy.section_badge_label }}</span>
        </div>

        {% if merch_copy.coming_soon_enabled %}
          <div class="coming-soon">
            <span class="badge">{{ merch_copy.coming_soon_badge }}</span>
            <div>
              <div class="coming-soon__title">{{ merch_copy.coming_soon_title }}</div>
              <p class="section__desc">{{ merch_copy.coming_soon_desc }}</p>
            </div>
          </div>
        {% endif %}

        <div class="grid grid--cards">
          <article class="card">
            {% if merch_copy.card_1_photo %}
              <div class="card__media">
                <img src="{{ merch_copy.card_1_photo.url }}" alt="{{ merch_copy.card_1_photo_alt|default:merch_copy.card_1_title }}" loading="lazy" decoding="async">
              </div>
            {% else %}
              <div class="sk"></div>
            {% endif %}
            <div class="card__body">
              <h3 class="diesel">{{ merch_copy.card_1_title }}</h3>
              <p class="section__desc">{{ merch_copy.card_1_desc }}</p>
              {% if merch_copy.card_1_colors or merch_copy.card_1_sizes %}
                <dl class="card__meta">
                  {% if merch_copy.card_1_colors %}
                    <div class="card__meta-row">
                      <dt>{{ merch_copy.card_colors_label }}</dt>
                      <dd>{{ merch_copy.card_1_colors }}</dd>
                    </div>
                  {% endif %}
                  {% if merch_copy.card_1_sizes %}
                    <div class="card__meta-row">
                      <dt>{{ merch_copy.card_sizes_label }}</dt>
                      <dd>{{ merch_copy.card_1_sizes }}</dd>
                    </div>
                  {% endif %}
                </dl>
              {% endif %}
            </div>
          </article>

          <article class="card">
            {% if merch_copy.card_2_photo %}
              <div class="card__media">
                <img src="{{ merch_copy.card_2_photo.url }}" alt="{{ merch_copy.card_2_photo_alt|default:merch_copy.card_2_title }}" loading="lazy" decoding="async">
              </div>
            {% else %}
              <div class="sk"></div>
            {% endif %}
            <div class="card__body">
              <h3 class="diesel">{{ merch_copy.card_2_title }}</h3>
              <p class="section__desc">{{ merch_copy.card_2_desc }}</p>
              {% if merch_copy.card_2_colors or merch_copy.card_2_sizes %}
                <dl class="card__meta">
                  {% if merch_copy.card_2_colors %}
                    <div class="card__meta-row">
                      <dt>{{ merch_copy.card_colors_label }}</dt>
                      <dd>{{ merch_copy.card_2_colors }}</dd>
                    </div>
                  {% endif %}
                  {% if merch_copy.card_2_sizes %}
                    <div class="card__meta-row">
                      <dt>{{ merch_copy.card_sizes_label }}</dt>
                      <dd>{{ merch_copy.card_2_sizes }}</dd>
                    </div>
                  {% endif %}
                </dl>
              {% endif %}
            </div>
          </article>

          <article class="card">
            {% if merch_copy.card_3_photo %}
              <div class="card__media">
                <img src="{{ merch_copy.card_3_photo.url }}" alt="{{ merch_copy.card_3_photo_alt|default:merch_copy.card_3_title }}" loading="lazy" decoding="async">
              </div>
            {% else %}
              <div class="sk"></div>
            {% endif %}
            <div class="card__body">
              <h3 class="diesel">{{ merch_copy.card_3_title }}</h3>
              <p class="section__desc">{{ merch_copy.card_3_desc }}</p>
              {% if merch_copy.card_3_colors or merch_copy.card_3_sizes %}
                <dl class="card__meta">
                  {% if merch_copy.card_3_colors %}
                    <div class="card__meta-row">
                      <dt>{{ merch_copy.card_colors_label }}</dt>
                      <dd>{{ merch_copy.card_3_colors }}</dd>
                    </div>
                  {% endif %}
                  {% if merch_copy.card_3_sizes %}
                    <div class="card__meta-row">
                      <dt>{{ merch_copy.card_sizes_label }}</dt>
                      <dd>{{ merch_copy.card_3_sizes }}</dd>
                    </div>
                  {% endif %}
                </dl>
              {% endif %}
            </div>
          </article>

          <article class="card">
            {% if merch_copy.card_4_photo %}
              <div class="card__media">
                <img src="{{ merch_copy.card_4_photo.url }}" alt="{{ merch_copy.card_4_photo_alt|default:merch_copy.card_4_title }}" loading="lazy" decoding="async">
              </div>
            {% else %}
              <div class="sk"></div>
            {% endif %}
            <div class="card__body">
              <h3 class="diesel">{{ merch_copy.card_4_title }}</h3>
              <p class="section__desc">{{ merch_copy.card_4_desc }}</p>
              {% if merch_copy.card_4_colors or merch_copy.card_4_sizes %}
                <dl class="card__meta">
                  {% if merch_copy.card_4_colors %}
                    <div class="card__meta-row">
                      <dt>{{ merch_copy.card_colors_label }}</dt>
                      <dd>{{ merch_copy.card_4_colors }}</dd>
                    </div>
                  {% endif %}
                  {% if merch_copy.card_4_sizes %}
                    <div class="card__meta-row">
                      <dt>{{ merch_copy.card_sizes_label }}</dt>
                      <dd>{{ merch_copy.card_4_sizes }}</dd>
                    </div>
                  {% endif %}
                </dl>
              {% endif %}
            </div>
          </article>
        </div>

        {% if merch_copy.social_link_1_url or merch_copy.social_link_2_url or merch_copy.social_link_3_url or merch_copy.social_link_4_url %}
          <div class="social">
            <div>
              <div class="social__title">{{ merch_copy.social_section_title }}</div>
              <p class="section__desc">{{ merch_copy.social_section_desc }}</p>
            </div>
            <div class="social__links">
              {% if merch_copy.social_link_1_url %}
                <a class="social__link" href="{{ merch_copy.social_link_1_url }}" target="_blank" rel="noopener">{{ merch_copy.social_link_1_label }}</a>
              {% endif %}
              {% if merch_copy.social_link_2_url %}
                <a class="social__link" href="{{ merch_copy.social_link_2_url }}" target="_blank" rel="noopener">{{ merch_copy.social_link_2_label }}</a>
              {% endif %}
              {% if merch_copy.social_link_3_url %}
                <a class="social__link" href="{{ merch_copy.social_link_3_url }}" target="_blank" rel="noopener">{{ merch_copy.social_link_3_label }}</a>
              {% endif %}
              {% if merch_copy.social_link_4_url %}
                <a class="social__link" href="{{ merch_copy.social_link_4_url }}" target="_blank" rel="noopener">{{ merch_copy.social_link_4_label }}</a>
              {% endif %}
            </div>
          </div>
        {% endif %}

        <div class="btn-row" style="margin-top:1.5rem">
          <a class="btn btn--primary" href="{% url 'home' %}">{{ merch_copy.bottom_cta_label }}</a>
          <!-- <a class="btn btn--ghost" href="{% url 'client-dashboard' %}#services">Book an install</a> -->
        </div>
      </div>
    </section>
  </main>

  {% include "includes/site_footer.html" %}

  <!-- Smoke (same as Store/Financing) -->
  <script src="https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.min.js"></script>
  <script src="{% static 'admin/js/bgm-smoke.js' %}"></script>

  <!-- Contact FAB + Modal -->
  <button type="button" id="contactFab" class="contact-fab"
          aria-haspopup="dialog" aria-controls="contactModal" aria-expanded="false">
    <svg viewBox="0 0 24 24" aria-hidden="true">
      <path d="M6.6 10.8c1.5 2.9 3.7 5.1 6.6 6.6l2.2-2.2c.3-.3.8-.4 1.2-.3 1 .3 2.1.5 3.2.5.7 0 1.2.5 1.2 1.2v3.5c0 .7-.5 1.2-1.2 1.2C9.8 21.5 2.5 14.2 2.5 4.2c0-.7.5-1.2 1.2-1.2H7c.7 0 1.2.5 1.2 1.2 0 1.1.2 2.2.5 3.2.1.4 0 .9-.3 1.2L6.6 10.8z"/>
    </svg>
    {{ merch_copy.contact_fab_label }}
  </button>

  <div id="contactModal" class="contact-modal" role="dialog" aria-modal="true" aria-labelledby="contactTitle">
    <div class="contact-dialog">
      <button class="contact-close" type="button" aria-label="{{ merch_copy.contact_close_label }}">×</button>
      <h2 id="contactTitle" class="contact-title">{{ merch_copy.contact_modal_title }}</h2>

      <div class="contact-body">
        {% with contact_email=merch_copy.contact_email|default:"" contact_phone=merch_copy.contact_phone|default:"" contact_phone_display=merch_copy.contact_phone_display|default:merch_copy.contact_phone %}
          {% if contact_email %}
            <div class="contact-row">
              <div>
                <div><a href="mailto:{{ contact_email }}">{{ contact_email }}</a></div>
                <div class="contact-sub">{{ merch_copy.contact_email_label }}</div>
              </div>
              <button class="contact-btn" data-copy="{{ contact_email }}" type="button">{{ merch_copy.contact_copy_label }}</button>
            </div>
          {% endif %}

          {% if contact_phone %}
            <div class="contact-row">
              <div>
                <div><a href="tel:{{ contact_phone }}">{{ contact_phone_display }}</a></div>
                <div class="contact-sub">{{ merch_copy.contact_phone_label }}</div>
              </div>
              <div style="display:flex;gap:.5rem;flex-wrap:wrap">
                <a class="contact-btn" href="tel:{{ contact_phone }}">{{ merch_copy.contact_call_label }}</a>
                <button class="contact-btn" data-copy="{{ contact_phone }}" type="button">{{ merch_copy.contact_copy_label }}</button>
              </div>
            </div>
          {% endif %}

          <div class="contact-actions">
            {% if contact_email %}
              <a class="contact-btn" href="mailto:{{ contact_email }}?subject={{ merch_copy.contact_email_subject|urlencode }}">{{ merch_copy.contact_write_email_label }}</a>
            {% endif %}
            {% if contact_phone %}
              <a class="contact-btn" href="sms:{{ contact_phone }}">{{ merch_copy.contact_text_label }}</a>
            {% endif %}
          </div>
        {% endwith %}
      </div>
    </div>
  </div>

  <script src="{% static 'js/topbar.js' %}"></script>

  <script>
    /* Contact modal & clipboard (unchanged behavior, cleaned scope) */
    (function(){
      const fab   = document.getElementById('contactFab');
      const modal = document.getElementById('contactModal');
      const closeBtn = modal.querySelector('.contact-close');
      let lastFocus = null;

      function openModal(){
        lastFocus = document.activeElement;
        modal.setAttribute('open','');
        fab.setAttribute('aria-expanded','true');
        setTimeout(()=>closeBtn.focus(),0);
        document.addEventListener('keydown', onKey);
      }
      function closeModal(){
        modal.removeAttribute('open');
        fab.setAttribute('aria-expanded','false');
        if (lastFocus) lastFocus.focus();
        document.removeEventListener('keydown', onKey);
      }
      function onKey(e){
        if (e.key === 'Escape') closeModal();
        if (e.key === 'Tab'){
          const focusables = modal.querySelectorAll('a,button,[tabindex]:not([tabindex="-1"])');
          const list = Array.from(focusables).filter(el=>!el.disabled && el.offsetParent!==null);
          if(!list.length) return;
          const first = list[0], last = list[list.length-1];
          if(e.shiftKey && document.activeElement===first){ e.preventDefault(); last.focus(); }
          else if(!e.shiftKey && document.activeElement===last){ e.preventDefault(); first.focus(); }
        }
      }

      fab.addEventListener('click', openModal);
      closeBtn.addEventListener('click', closeModal);
      modal.addEventListener('click', (e)=>{ if(e.target===modal) closeModal(); });

      modal.querySelectorAll('[data-copy]').forEach(btn=>{
        btn.addEventListener('click', async ()=>{
          try{
            await navigator.clipboard.writeText(btn.dataset.copy);
            btn.textContent='{{ merch_copy.contact_copy_success_label|escapejs }}';
            setTimeout(()=>btn.textContent='{{ merch_copy.contact_copy_label|escapejs }}',1200);
          }catch{
            btn.textContent='{{ merch_copy.contact_copy_failed_label|escapejs }}';
            setTimeout(()=>btn.textContent='{{ merch_copy.contact_copy_label|escapejs }}',1200);
          }
        });
      });
    })();
  </script>

  {% include "includes/analytics_tracker.html" %}
</body>
</html>
