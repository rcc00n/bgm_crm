{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>{% block title %}BGM — Store{% endblock %}</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  {% block marketing_meta %}
    {% with meta_title="BGM Customs — Storefront" meta_description="Shop curated parts, aero, lighting, and performance upgrades from BGM Customs." meta_section="store" %}
      {% include "includes/marketing_head.html" %}
    {% endwith %}
  {% endblock %}

  <!-- Fonts -->
  <link rel="preload" href="{% static 'fonts/Diesel.ttf' %}" as="font" type="font/ttf" crossorigin>
  <link rel="preload" href="{% static 'fonts/Ford.ttf' %}"   as="font" type="font/ttf" crossorigin>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap" rel="stylesheet">
  {% if font_settings and font_settings.preload_fonts %}
    {% for font in font_settings.preload_fonts %}
      <link rel="preload" href="{{ font.url }}" as="font" type="{{ font.mime_type|default:'font/ttf' }}" crossorigin>
    {% endfor %}
  {% endif %}

  <style>
    /* ========================== VARIABLES & FONTS ========================== */
    :root{
      --bg:#0a0a0a; --fg:#eaeaea; --muted:#bdbdbd; --muted-2:rgba(255,255,255,.78);
      --accent:#d50000; --accent-2:#ff1a1a; --accent-dark:#b60000;
      --panel:#121212; --panel-2:#131313; --line:rgba(255,255,255,.12);
      --field-bg:rgba(255,255,255,.06); --card-border:rgba(255,255,255,.08);
      --radius-lg:1.25rem; --radius-sm:.6rem; --shadow:0 10px 30px rgba(0,0,0,.45);
      --container:clamp(320px,92vw,1280px);
      --site-header-height:72px;
      --site-header-toggle-size:46px;

      --font-body: "Inter", "Segoe UI", system-ui, -apple-system, BlinkMacSystemFont, "Roboto", Arial, sans-serif;
      --font-display: "Diesel", ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif; /* brand mark */
      --font-head: "Diesel", ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif;       /* accent headers */
      --font-ui: var(--font-display);
    }

    @font-face{
      font-family:"Diesel";
      src:url("{% static 'fonts/Diesel.ttf' %}") format("truetype");
      font-weight:100 900; font-style:normal; font-display:swap;
    }
    @font-face{
      font-family:"Ford";
      src:url("{% static 'fonts/Ford.ttf' %}") format("truetype");
      font-weight:100 900; font-style:normal; font-display:swap;
    }
    {% if font_settings %}
      {% for font in font_settings.fonts %}
        {% if font.has_source %}
    @font-face{
      font-family:"{{ font.family }}";
      src:url("{{ font.url }}") format("{{ font.format|default:'truetype' }}");
      font-weight:{{ font.weight|default:"400" }};
      font-style:{{ font.style|default:"normal" }};
      font-display:{{ font.display|default:"swap" }};
    }
        {% endif %}
      {% endfor %}
      {% with body_stack=font_settings.body.stack|default:'"Inter", system-ui, sans-serif' %}
      {% with heading_stack=font_settings.heading.stack|default:body_stack %}
      {% with ui_stack=font_settings.ui.stack|default:body_stack %}
    :root{
      --font-body: {{ body_stack|safe }};
      --font-head: {{ heading_stack|safe }};
      --font-ui:   {{ ui_stack|safe }};
    }
      {% with body_styles=font_settings.styles.body heading_styles=font_settings.styles.heading ui_styles=font_settings.styles.ui %}
      {% if body_styles or heading_styles or ui_styles %}
    :root{
      {% if body_styles.size %}--font-body-size: {{ body_styles.size|escape }};{% endif %}
      {% if body_styles.line_height %}--font-body-line-height: {{ body_styles.line_height|escape }};{% endif %}
      {% if body_styles.weight %}--font-body-weight: {{ body_styles.weight|escape }};{% endif %}
      {% if body_styles.letter_spacing %}--font-body-letter-spacing: {{ body_styles.letter_spacing|escape }};{% endif %}
      {% if heading_styles.weight %}--font-head-weight: {{ heading_styles.weight|escape }};{% endif %}
      {% if heading_styles.letter_spacing %}--font-head-letter-spacing: {{ heading_styles.letter_spacing|escape }};{% endif %}
      {% if heading_styles.transform %}--font-head-transform: {{ heading_styles.transform|escape }};{% endif %}
      {% if ui_styles.weight %}--font-ui-weight: {{ ui_styles.weight|escape }};{% endif %}
      {% if ui_styles.letter_spacing %}--font-ui-letter-spacing: {{ ui_styles.letter_spacing|escape }};{% endif %}
      {% if ui_styles.transform %}--font-ui-transform: {{ ui_styles.transform|escape }};{% endif %}
    }
      {% if body_styles.size or body_styles.line_height or body_styles.weight or body_styles.letter_spacing %}
    body{
      {% if body_styles.size %}font-size: var(--font-body-size) !important;{% endif %}
      {% if body_styles.line_height %}line-height: var(--font-body-line-height) !important;{% endif %}
      {% if body_styles.weight %}font-weight: var(--font-body-weight) !important;{% endif %}
      {% if body_styles.letter_spacing %}letter-spacing: var(--font-body-letter-spacing) !important;{% endif %}
    }
      {% endif %}
      {% if heading_styles.weight or heading_styles.letter_spacing or heading_styles.transform %}
    h1,h2,h3,h4,h5,h6,.title,.section__title{
      {% if heading_styles.weight %}font-weight: var(--font-head-weight) !important;{% endif %}
      {% if heading_styles.letter_spacing %}letter-spacing: var(--font-head-letter-spacing) !important;{% endif %}
      {% if heading_styles.transform %}text-transform: var(--font-head-transform) !important;{% endif %}
    }
      {% endif %}
      {% if ui_styles.weight or ui_styles.letter_spacing or ui_styles.transform %}
    button,.btn,.badge,nav a,input,select,textarea,.site-header__toggle{
      {% if ui_styles.weight %}font-weight: var(--font-ui-weight) !important;{% endif %}
      {% if ui_styles.letter_spacing %}letter-spacing: var(--font-ui-letter-spacing) !important;{% endif %}
      {% if ui_styles.transform %}text-transform: var(--font-ui-transform) !important;{% endif %}
    }
      {% endif %}
      {% endif %}
      {% endwith %}
      {% endwith %}
      {% endwith %}
      {% endwith %}
    {% endif %}

    /* ============================== BASE / RESET ============================ */
    *,*::before,*::after{ box-sizing:border-box; margin:0; padding:0; }
    html{ text-rendering:optimizeLegibility; -webkit-font-smoothing:antialiased; }
    body{ background:var(--bg); color:var(--fg); font-family:var(--font-body); }
    img{ max-width:100%; height:auto; display:block; }
    a{ color:inherit; text-decoration:none; }

    .container{ width:var(--container); margin-inline:auto; padding-inline:1rem; }
    .visually-hidden{ position:absolute!important; height:1px; width:1px; overflow:hidden; clip:rect(1px,1px,1px,1px); white-space:nowrap; }

    /* Buttons & badges */
    .btn{
      display:inline-flex; align-items:center; gap:.6em;
      padding:.78rem 1.15rem; min-height:44px; line-height:1.1;
      border-radius:var(--radius-sm); border:1px solid transparent; cursor:pointer; transition:.2s;
      font-weight:800; letter-spacing:.02em; font-family:var(--font-body);
    }
    .btn--primary{ background:var(--accent); color:#fff; }
    .btn--primary:hover{ transform:translateY(-2px); box-shadow:0 12px 22px rgba(213,0,0,.25); }
    .btn--ghost{ background:transparent; border-color:var(--line); color:var(--fg); }
    .btn--ghost:hover{ border-color:var(--accent); color:var(--accent); }
    .btn-row{ display:flex; gap:.6rem; margin-top:1.2rem; flex-wrap:wrap; }

    .badge{ display:inline-block; padding:.15rem .55rem; border-radius:999px; background:var(--accent); color:#fff; font-size:.78rem; }
    .badge--dealer{ background:rgba(23,212,91,.12); border:1px solid rgba(23,212,91,.4); color:#17d45b; }

    /* ============================== HEADER ================================= */
    .site-header{
      position:sticky; top:0;
      background:#000; border-bottom:1px solid var(--line);
      z-index:3200; /* above content & FAB */
    }
    .site-header__inner{
      display:flex; align-items:center; justify-content:space-between;
      gap:1.25rem; padding:.7rem 0;
    }

    /* Brand (text mark uses Diesel) */
    .brand{ display:flex; align-items:baseline; gap:.9rem; min-width:max-content; font-weight:900; letter-spacing:.5px; }
    .brand__logo{
      all:unset; display:inline-flex; gap:.5rem; line-height:1;
      font-weight:var(--topbar-brand-weight, 900);
      letter-spacing:var(--topbar-brand-letter-spacing, .06em);
      font-size:var(--topbar-brand-size, clamp(1.2rem,1.8vw,1.55rem));
      font-family:var(--topbar-brand-font, var(--font-display));
      text-transform:var(--topbar-brand-transform, uppercase);
    }
    .brand__word--white{ color:#fff; }
    .brand__word--red{ color:var(--accent); }
    .brand__tagline{
      margin-left:1.1rem; white-space:nowrap; font-size:clamp(.78rem,.95vw,.95rem);
      font-weight:900; letter-spacing:.12em; line-height:1; color:rgba(255,255,255,.78); text-transform:uppercase;
      font-family:var(--topbar-nav-font, var(--font-ui, var(--font-body)));
    }

    /* Nav (desktop) */
    nav{ margin-left:auto; }
    nav ul{ display:flex; align-items:center; gap:1.4rem; list-style:none; }
    nav a{
      display:inline-flex; align-items:center; gap:.45rem;
      line-height:1; font-weight:800; letter-spacing:.08em; font-size:var(--topbar-nav-size-desktop, .82rem);
      text-transform:uppercase; color:rgba(255,255,255,.78);
      font-family:var(--topbar-nav-font, var(--font-ui, var(--font-body)));
    }
    nav a:hover, nav a[aria-current="page"]{ color:#fff; }
    nav .btn, nav .btn--ghost{ padding:0; border:0; background:none; border-radius:0; }
    nav .badge{ padding:.15rem .55rem; font-size:.78rem; transform:none; }

    .site-header .brand,
    .site-header .brand__logo,
    .site-header .brand__logo .brand__word{
      font-family:var(--topbar-brand-font, var(--font-display));
      font-style:normal;
    }
    .site-header .brand__tagline,
    .site-header nav a,
    .site-header nav .btn,
    .site-header nav .btn--ghost{
      font-family:var(--topbar-nav-font, var(--font-ui, var(--font-body)));
      font-style:normal;
    }

    /* Mobile toggle (hamburger) */
    .site-header__toggle{
      display:none; align-items:center; justify-content:center;
      width:var(--site-header-toggle-size); height:var(--site-header-toggle-size);
      border-radius:.85rem; border:1px solid rgba(255,255,255,.16);
      background:rgba(255,255,255,.06); color:#fff; cursor:pointer;
      transition:transform .18s, background .18s, border-color .18s;
    }
    .site-header__toggle:hover{ background:rgba(255,255,255,.12); border-color:rgba(255,255,255,.28); }
    .site-header__toggle:focus-visible{ outline:2px solid #fff; outline-offset:3px; }
    .site-header__toggle-box{ position:relative; width:20px; height:14px; display:block; }
    .site-header__toggle-lines,
    .site-header__toggle-lines::before,
    .site-header__toggle-lines::after{
      content:""; position:absolute; left:0; width:100%; height:2px; border-radius:999px; background:currentColor; transition:transform .22s, opacity .22s, background .22s;
    }
    .site-header__toggle-lines{ top:50%; transform:translateY(-50%); }
    .site-header__toggle-lines::before{ top:-6px; }
    .site-header__toggle-lines::after{ top:6px; }
    .site-header--open .site-header__toggle{ background:rgba(255,255,255,.16); border-color:rgba(255,255,255,.38); }
    .site-header--open .site-header__toggle-lines{ background:transparent; }
    .site-header--open .site-header__toggle-lines::before{ transform:translateY(6px) rotate(45deg); }
    .site-header--open .site-header__toggle-lines::after{ transform:translateY(-6px) rotate(-45deg); }

    /* ============================== HERO / TYPO ============================ */
    .hero{ background: radial-gradient(1000px 420px at 10% -10%, rgba(255,26,26,.15), transparent 60%), radial-gradient(800px 360px at 90% 0%, rgba(213,0,0,.18), transparent 65%), linear-gradient(180deg, #070707 0%, #000 100%); }
    .hero__inner{ display:grid; grid-template-columns:1.1fr .9fr; gap:2rem; padding:clamp(2rem,6vw,4.5rem) 0; align-items:center; }

    .title{ font-family:var(--font-head); font-size:clamp(2rem,4.6vw,3.4rem); font-weight:900; line-height:1.15; letter-spacing:.01em; text-transform:uppercase; color:#fff; text-shadow:0 0 18px rgba(213,0,0,.25); }
    .lead{ color:var(--muted); }

    /* =============================== CONTENT ============================== */
    .section{ padding:clamp(2rem,6vw,4rem) 0; border-top:1px solid var(--line); }
    .section__head{ display:flex; align-items:end; justify-content:space-between; gap:1rem; margin-bottom:1.1rem; }
    .section__title{ font-family:var(--font-body); font-size:1.6rem; font-weight:900; color:#fff; }
    .section__desc{ color:var(--muted); }

    .grid{ display:grid; gap:1rem; }
    .grid--cards{ grid-template-columns:repeat(auto-fill,minmax(260px,1fr)); }

    .card{
      background:linear-gradient(180deg, rgba(18,18,18,.9), rgba(19,19,19,.9));
      border:1px solid var(--card-border); border-radius:1rem; padding:1rem; box-shadow:var(--shadow);
      transition: transform .18s ease, box-shadow .18s ease, border-color .18s ease;
    }
    .card:hover{ transform:translateY(-3px); border-color:rgba(213,0,0,.28); box-shadow:0 14px 36px rgba(0,0,0,.5), 0 0 24px rgba(213,0,0,.18); }
    .card__img{ aspect-ratio:16/9; border-radius:.8rem; background:#0b0b0b; object-fit:cover; }

    .price{ display:flex; align-items:center; gap:.5rem; font-family:var(--font-body); font-weight:800; }
    .old{ color:rgba(255,255,255,.45); text-decoration:line-through; }

    .field{ background:var(--field-bg); border:1px solid var(--card-border); border-radius:.6rem; padding:.6rem .8rem; color:var(--fg); font:inherit; }

    /* Search */
    .search-bar{
      display:flex;
      flex-wrap:nowrap;
      align-items:center;
      gap:.75rem;
      padding:.75rem .9rem;
      border-radius:1rem;
      border:1px solid var(--card-border);
      background:rgba(18,18,18,.75);
      margin-bottom:.6rem;
    }
    .search-bar__field{
      position:relative;
      flex:1 1 auto;
      min-width:0;
    }
    .search-bar__input{
      width:100%;
      min-height:44px;
      padding:.7rem 2.6rem .7rem 2.4rem;
      border-radius:.7rem;
      border:1px solid var(--card-border);
      background:var(--field-bg);
      color:var(--fg);
      font:inherit;
    }
    .search-bar__input::placeholder{ color:var(--muted); }
    .search-bar__icon{
      position:absolute;
      left:.75rem;
      top:50%;
      transform:translateY(-50%);
      opacity:.7;
      pointer-events:none;
      font-size:1rem;
    }
    .search-bar__icon svg{ width:18px; height:18px; fill:currentColor; display:block; }
    .search-bar__clear{
      position:absolute;
      right:.45rem;
      top:50%;
      transform:translateY(-50%);
      border:0;
      background:transparent;
      color:var(--muted);
      padding:.35rem .6rem;
      border-radius:.6rem;
      cursor:pointer;
      font-weight:700;
    }
    .search-bar__clear:hover{ color:#fff; }
    .search-bar__meta{
      font-size:.9rem;
      color:var(--muted);
      margin-left:auto;
      white-space:nowrap;
    }
    .search-empty{
      margin:.2rem 0 1rem;
      color:var(--muted);
      font-style:italic;
    }
    .search-results{
      margin:.2rem 0 1.2rem;
    }
    .search-results[hidden]{ display:none; }
    .search-results__title{
      margin:.4rem 0 .9rem;
      font-size:1.1rem;
      font-weight:900;
      color:#fff;
    }

    /* =============================== FOOTER =============================== */
    .site-footer{ border-top:1px solid var(--line); padding:1.6rem 0; color:var(--muted); font-size:.95rem; margin-top:2rem; }
    .site-footer__inner{ display:flex; align-items:center; justify-content:space-between; gap:1rem; flex-wrap:wrap; }
    .site-footer .brand__logo{ width:34px; height:34px; border-radius:10px; background:radial-gradient(90% 90% at 30% 30%, var(--accent-2), var(--accent)); box-shadow:0 0 40px -6px var(--accent-2); }

    /* ============================= CONTACT FAB ============================ */
    .contact-fab{
      position:fixed; right:22px; bottom:22px; z-index:2100;
      display:inline-flex; align-items:center; gap:.6em;
      padding:.9rem 1.15rem; border-radius:999px; border:1px solid rgba(255,255,255,.08);
      background:linear-gradient(180deg,var(--accent) 0%,var(--accent-dark) 100%);
      color:#fff; font-weight:900; letter-spacing:.02em; line-height:1;
      cursor:pointer; transition:.18s ease; box-shadow:0 12px 26px rgba(213,0,0,.28), 0 0 26px rgba(213,0,0,.18);
      font-family:"Helvetica Neue", Arial, sans-serif; font-style:normal;
    }
    .contact-fab:hover{ transform:translateY(-2px); filter:saturate(1.05); }
    .contact-fab:focus-visible{ outline:2px solid #fff; outline-offset:3px; }
    .contact-fab svg{ width:20px; height:20px; fill:currentColor; opacity:.95; }

    .contact-modal{
      position:fixed; inset:0; z-index:2200; display:none;
      align-items:center; justify-content:center; padding:1rem;
      background:rgba(0,0,0,.65); backdrop-filter:blur(2px);
    }
    .contact-modal[open]{ display:flex; }
    .contact-dialog{
      width:min(560px, 92vw);
      background:linear-gradient(180deg,#0c0c0c,#121212);
      border:1px solid var(--line); border-radius:1rem;
      padding:1.1rem 1.1rem .95rem; color:var(--fg);
      box-shadow:0 18px 44px rgba(0,0,0,.55), 0 0 32px rgba(213,0,0,.18);
      position:relative;
    }
    .contact-title{ font-family:var(--font-head); font-weight:900; letter-spacing:.005em; line-height:1.15; font-size:1.6rem; margin:.2rem 2.2rem 1rem .2rem; color:#fff; }
    .contact-close{
      position:absolute; right:12px; top:10px; width:36px; height:36px;
      border:1px solid var(--line); border-radius:.5rem; background:#0f0f0f; color:#bdbdbd; cursor:pointer; font-size:20px; line-height:1;
    }
    .contact-body{ display:grid; gap:.75rem; }
    .contact-row{
      display:flex; align-items:center; justify-content:space-between; gap:.6rem;
      background:rgba(255,255,255,.06); border:1px solid var(--line);
      border-radius:.7rem; padding:.7rem .8rem; font-family:"Helvetica Neue", Arial, sans-serif; font-style:normal;
    }
    .contact-row a{ color:#fff; font-weight:800; }
    .contact-sub{ color:rgba(255,255,255,.72); font-size:.95rem; }
    .contact-actions{ display:flex; gap:.6rem; margin-top:.9rem; flex-wrap:wrap; }
    .contact-btn{
      display:inline-flex; align-items:center; gap:.5em; padding:.7rem 1rem; border-radius:.55rem;
      border:1px solid var(--line); background:#0f0f0f; color:#fff; cursor:pointer; font-family:"Helvetica Neue", Arial, sans-serif; font-weight:800; font-style:normal;
    }
    .contact-btn:hover{ border-color:rgba(213,0,0,.45); box-shadow:0 0 16px rgba(213,0,0,.25); }
    body.no-contact-fab .contact-fab{ display:none !important; }

    /* =========================== MOBILE ADAPTATION ========================= */
    @media (max-width:1200px){ .brand__tagline{ display:none; } }
    @media (max-width:900px){
      .hero__inner{ grid-template-columns:1fr; }
      .search-bar{
        flex-direction:row;
        flex-wrap:nowrap;
        align-items:center;
        gap:.5rem;
        padding:.55rem .7rem;
      }
      .search-bar__input{
        min-height:40px;
        padding:.55rem 2.4rem .55rem 2.15rem;
      }
      .search-bar__meta{ margin-left:auto; font-size:.8rem; }
    }
    @media (max-width:520px){
      .search-bar__meta{ display:none; }
    }

    /* Mobile sheet */
    @media (max-width:960px){
      body.nav-open{ overflow:hidden; }

      .site-header{ --site-header-height:max(62px,10vh); }
      .site-header .container{ padding-inline:clamp(16px,4vw,24px); }
      .site-header__inner{ display:grid; grid-template-columns:auto max-content; align-items:center; gap:clamp(12px,3vw,24px); }
      .site-header__toggle{ display:inline-flex; }

      nav{
        position:fixed; inset:0; height:100dvh;
        padding-top:calc(var(--site-header-height) + 1rem + env(safe-area-inset-top));
        padding-inline:clamp(20px,6vw,36px);
        padding-bottom:calc(clamp(28px,12vh,46px) + env(safe-area-inset-bottom));
        background:rgba(5,5,5,.88); backdrop-filter:blur(18px) saturate(1.2);
        display:flex; align-items:flex-start;
        opacity:0; pointer-events:none; transform:translateY(-12px);
        transition:opacity .22s ease, transform .22s ease;
        z-index:3300; overflow-y:auto; -webkit-overflow-scrolling:touch; overscroll-behavior:contain;
      }
      nav ul{ flex-direction:column; align-items:stretch; gap:1.15rem; width:100%; }
      nav li{ width:100%; }
      nav a, nav .btn, nav .btn--ghost{
        width:100%; justify-content:space-between;
        background:rgba(255,255,255,.05); border:1px solid rgba(255,255,255,.12); border-radius:1rem;
        padding:1.1rem 1.2rem; font-size:1.05rem; letter-spacing:.035em; min-height:56px;
        box-shadow:inset 0 1px 0 rgba(255,255,255,.06), 0 10px 22px rgba(0,0,0,.18);
      }
      nav a .badge{ margin-left:.6rem; }

      /* open states: support both toggling strategies */
      .site-header--open nav,
      body.nav-open nav{
        opacity:1; pointer-events:auto; transform:translateY(0);
      }

      /* keep toggle above the sheet and hide FAB while open */
      .site-header__toggle{ position:relative; z-index:3400; }
      body.nav-open .contact-fab, .site-header--open ~ .contact-fab{ display:none !important; }
    }

    @media (prefers-reduced-motion:reduce){
      nav, .site-header__toggle, .site-header__toggle-lines, .card{ transition:none !important; }
    }
  </style>
<style id="mobile-sidebar-patch">
@media (max-width: 960px){
  .site-header{ z-index: 10000 !important; }             /* above everything */
  #siteNav{
    position: fixed !important;
    inset: 0 !important;
    height: 100dvh !important;
    z-index: 10001 !important;
    background: rgba(5,5,5,.92) !important;
    backdrop-filter: blur(18px) saturate(1.2);
    -webkit-backdrop-filter: blur(18px) saturate(1.2);
    padding-top: calc(var(--site-header-height) + 1rem + env(safe-area-inset-top)) !important;
    padding-inline: clamp(20px, 6vw, 36px) !important;
    padding-bottom: max(28px, env(safe-area-inset-bottom)) !important;
    display: flex !important;
    align-items: flex-start !important;
    overflow-y: auto !important;
    -webkit-overflow-scrolling: touch !important;
    overscroll-behavior: contain !important;

    opacity: 0; pointer-events: none; transform: translateY(-12px);
    transition: opacity .22s ease, transform .22s ease;
  }
  /* open in ALL cases */
  .site-header--open #siteNav,
  body.nav-open #siteNav,
  .site-header .site-header__toggle[aria-expanded="true"] ~ #siteNav{
    opacity: 1 !important;
    pointer-events: auto !important;
    transform: translateY(0) !important;
  }

  /* spacing + full‑width, comfy hit areas */
  #siteNav ul{ flex-direction: column; gap: 1.15rem; width: 100%; }
  #siteNav li{ width: 100%; }
  #siteNav a{
    width: 100%; min-height: 56px;
    padding: 1.15rem 1.2rem;
    border-radius: 1rem;
    background: rgba(255,255,255,.05);
    border: 1px solid rgba(255,255,255,.12);
    box-shadow: 0 8px 24px rgba(0,0,0,.35);
    display: flex; align-items: center; justify-content: space-between;
  }
  .site-header__toggle{ position: relative; z-index: 10002 !important; }
  body.nav-open .contact-fab,
  .site-header--open ~ .contact-fab{ display: none !important; }
}
</style>
<style id="mobile-sidebar-unified">
@media (max-width: 960px){
  body.nav-open{ overflow:hidden; }
  .site-header{ z-index:10000 !important; }
  .site-header__toggle{ position: relative; z-index:10002 !important; }
  #siteNav{
    position:fixed !important;
    inset:0 !important;
    height:100dvh !important;
    padding-top:calc(var(--site-header-height) + 1rem) !important;
    padding-inline:clamp(20px,6vw,36px) !important;
    padding-bottom:calc(28px + env(safe-area-inset-bottom)) !important;
    background:rgba(6,6,6,.62) !important;
    -webkit-backdrop-filter:blur(24px) saturate(1.2) !important;
    backdrop-filter:blur(24px) saturate(1.2) !important;
    display:flex !important;
    align-items:flex-start !important;
    opacity:0;
    pointer-events:none;
    transform:translateY(-12px);
    transition:opacity .22s ease, transform .22s ease;
    overflow-y:auto !important;
    overscroll-behavior:contain;
    z-index:10001 !important;
  }
  .site-header--open #siteNav,
  body.nav-open #siteNav,
  .site-header__toggle[aria-expanded="true"] ~ #siteNav{
    opacity:1 !important;
    pointer-events:auto !important;
    transform:translateY(0) !important;
  }
  #siteNav ul{
    flex-direction:column !important;
    align-items:stretch !important;
    gap:1rem !important;
    width:100% !important;
  }
  #siteNav li{ width:100% !important; }
  #siteNav a,
  #siteNav .btn,
  #siteNav .btn--ghost{
    width:100% !important;
    min-height:56px;
    padding:1.1rem 1.2rem !important;
    border-radius:1rem !important;
    background:rgba(255,255,255,.05) !important;
    border:1px solid rgba(255,255,255,.12) !important;
    display:flex !important;
    align-items:center !important;
    justify-content:space-between !important;
  }
  body.nav-open .contact-fab{ display:none !important; }
}
</style>

  {% include "includes/site_notice_style.html" %}
  {% block extra_head %}{% endblock %}
</head>
<body>
  {% include "includes/marketing_body.html" %}
  {% include "includes/site_notice_markup.html" with site_notice_version="offer-v1" %}

  {% include "includes/topbar_client_v3.html" %}

  {% block body %}{% endblock %}

  {% include "includes/site_footer.html" %}

  <!-- Contact FAB + Modal -->
  <button type="button" id="contactFab" class="contact-fab"
          aria-haspopup="dialog" aria-controls="contactModal" aria-expanded="false">
    <svg viewBox="0 0 24 24" aria-hidden="true">
      <path d="M6.6 10.8c1.5 2.9 3.7 5.1 6.6 6.6l2.2-2.2c.3-.3.8-.4 1.2-.3 1 .3 2.1.5 3.2.5.7 0 1.2.5 1.2 1.2v3.5c0 .7-.5 1.2-1.2 1.2C9.8 21.5 2.5 14.2 2.5 4.2c0-.7.5-1.2 1.2-1.2H7c.7 0 1.2.5 1.2 1.2 0 1.1.2 2.2.5 3.2.1.4 0 .9-.3 1.2L6.6 10.8z"/>
    </svg>
    {{ store_copy.contact_fab_label|default:"Contact us" }}
  </button>

  <div id="contactModal" class="contact-modal" role="dialog" aria-modal="true" aria-labelledby="contactTitle">
    <div class="contact-dialog">
      <button class="contact-close" type="button" aria-label="{{ store_copy.contact_close_label|default:"Close" }}">×</button>
      <h2 id="contactTitle" class="contact-title">{{ store_copy.contact_modal_title|default:"Contact us" }}</h2>

      <div class="contact-body">
        <div class="contact-row">
          <div>
            <div><a href="mailto:support@badguymotors.com">support@badguymotors.com</a></div>
            <div class="contact-sub">{{ store_copy.contact_email_label|default:"E-mail" }}</div>
          </div>
          <button class="contact-btn" data-copy="support@badguymotors.com" type="button">{{ store_copy.contact_copy_label|default:"Copy" }}</button>
        </div>

        <div class="contact-row">
          <div>
            <div><a href="tel:+14035250432">(403) 525-0432</a></div>
            <div class="contact-sub">{{ store_copy.contact_phone_label|default:"Phone" }}</div>
          </div>
          <div style="display:flex;gap:.5rem;flex-wrap:wrap">
            <a class="contact-btn" href="tel:+14035250432">{{ store_copy.contact_call_label|default:"Call" }}</a>
            <button class="contact-btn" data-copy="+1 403 525 0432" type="button">{{ store_copy.contact_copy_label|default:"Copy" }}</button>
          </div>
        </div>

        <div class="contact-actions">
          <a class="contact-btn" href="mailto:support@badguymotors.com?subject=Inquiry%20from%20website">{{ store_copy.contact_write_email_label|default:"Write e-mail" }}</a>
          <a class="contact-btn" href="sms:+14035250432">{{ store_copy.contact_text_label|default:"Text us" }}</a>
        </div>
      </div>
    </div>
  </div>

  <!-- Scripts -->
  <script src="{% static 'js/topbar.js' %}"></script>
  {% include "includes/site_notice_script.html" %}

  <script>
    /* Contact modal & clipboard */
    (function(){
      const fab   = document.getElementById('contactFab');
      const modal = document.getElementById('contactModal');
      const closeBtn = modal.querySelector('.contact-close');
      const copyLabel = "{{ store_copy.contact_copy_label|default:'Copy'|escapejs }}";
      const copySuccess = "{{ store_copy.contact_copy_success_label|default:'Copied'|escapejs }}";
      const copyFailed = "{{ store_copy.contact_copy_failed_label|default:'Copy failed'|escapejs }}";
      let lastFocus = null;

      function openModal(){
        lastFocus = document.activeElement;
        modal.setAttribute('open','');
        fab.setAttribute('aria-expanded','true');
        setTimeout(()=>closeBtn.focus(),0);
        document.addEventListener('keydown', onKey);
      }
      function closeModal(){
        modal.removeAttribute('open');
        fab.setAttribute('aria-expanded','false');
        if (lastFocus) lastFocus.focus();
        document.removeEventListener('keydown', onKey);
      }
      function onKey(e){
        if (e.key === 'Escape') closeModal();
        if (e.key === 'Tab'){
          const focusables = modal.querySelectorAll('a,button,[tabindex]:not([tabindex="-1"])');
          const list = Array.from(focusables).filter(el=>!el.disabled && el.offsetParent!==null);
          if(!list.length) return;
          const first = list[0], last = list[list.length-1];
          if(e.shiftKey && document.activeElement===first){ e.preventDefault(); last.focus(); }
          else if(!e.shiftKey && document.activeElement===last){ e.preventDefault(); first.focus(); }
        }
      }

      fab.addEventListener('click', openModal);
      closeBtn.addEventListener('click', closeModal);
      modal.addEventListener('click', (e)=>{ if(e.target===modal) closeModal(); });

      modal.querySelectorAll('[data-copy]').forEach(btn=>{
        btn.addEventListener('click', async ()=>{
          try{
            await navigator.clipboard.writeText(btn.dataset.copy);
            btn.textContent = copySuccess;
            setTimeout(()=>btn.textContent = copyLabel,1200);
          }catch{
            btn.textContent = copyFailed;
            setTimeout(()=>btn.textContent = copyLabel,1200);
          }
        });
      });
    })();
  </script>

  <script>
    /* Dynamic product search (filters visible cards only) */
    (function(){
      const bars = document.querySelectorAll('[data-product-search]');
      if (!bars.length) return;

      bars.forEach((bar) => {
        const input = bar.querySelector('input[type="search"]');
        if (!input) return;
        const clearBtn = bar.querySelector('[data-search-clear]');
        const countEl = bar.querySelector('[data-search-count]');
        const root = bar.closest('[data-search-root]') || document;
        const emptyEl = root.querySelector('[data-search-empty]');
        const mode = bar.dataset.searchMode || 'filter';
        let resultsHost = root.querySelector('[data-search-results]');
        let resultsGrid = resultsHost ? resultsHost.querySelector('[data-search-results-grid]') : null;
        if (mode === 'swap' && !resultsHost) {
          resultsHost = document.createElement('div');
          resultsHost.className = 'search-results';
          resultsHost.setAttribute('data-search-results', '');
          resultsHost.hidden = true;
          resultsHost.innerHTML = '<h3 class="search-results__title">Search results</h3><div class="grid grid--cards" data-search-results-grid></div>';
          bar.insertAdjacentElement('afterend', resultsHost);
          resultsGrid = resultsHost.querySelector('[data-search-results-grid]');
        }
        const items = Array.from(root.querySelectorAll('[data-search-item]'))
          .filter(item => !item.closest('[data-search-results]'));

        const keyFor = (item) => {
          if (item.dataset.searchKey) return item.dataset.searchKey;
          const raw = item.dataset.searchText || item.textContent || '';
          const key = raw.toLowerCase();
          item.dataset.searchKey = key;
          return key;
        };

        const renderResults = (matches) => {
          if (!resultsHost || !resultsGrid) return;
          resultsGrid.innerHTML = '';
          if (!matches.length) {
            resultsHost.hidden = true;
            return;
          }
          const fragment = document.createDocumentFragment();
          matches.forEach((item) => {
            const clone = item.cloneNode(true);
            clone.removeAttribute('hidden');
            clone.removeAttribute('data-search-item');
            clone.removeAttribute('data-search-key');
            clone.querySelectorAll('[id]').forEach(el => el.removeAttribute('id'));
            fragment.appendChild(clone);
          });
          resultsGrid.appendChild(fragment);
          resultsHost.hidden = false;
        };

        const update = () => {
          const query = input.value.trim().toLowerCase();
          let matches = 0;
          const matchedItems = [];
          items.forEach((item) => {
            const match = !query || keyFor(item).includes(query);
            if (match) {
              matches += 1;
              matchedItems.push(item);
            }
            if (mode !== 'swap') {
              item.hidden = !match;
            }
          });
          if (countEl) {
            countEl.textContent = query ? `${matches} result${matches === 1 ? '' : 's'}` : '';
          }
          if (clearBtn) {
            clearBtn.hidden = !query;
          }
          if (emptyEl) {
            emptyEl.hidden = !(query && matches === 0);
          }
          if (mode === 'swap') {
            if (query) {
              items.forEach((item) => { item.hidden = true; });
              renderResults(matchedItems);
            } else {
              items.forEach((item) => { item.hidden = false; });
              if (resultsHost) {
                resultsHost.hidden = true;
                if (resultsGrid) resultsGrid.innerHTML = '';
              }
            }
          }
        };

        input.addEventListener('input', update);
        if (clearBtn) {
          clearBtn.addEventListener('click', () => {
            input.value = '';
            input.focus();
            update();
          });
        }
        update();
      });
    })();
  </script>

  {% include "includes/analytics_tracker.html" %}
</body>
</html>
