{% extends "admin/base_site.html" %}
{% load static %}
{% block breadcrumbs %}{% endblock %}
{% block content_title %}{% endblock %}
{% block object-tools %}{% endblock %}
{% block title %}Daily Calendar{% endblock %}
{% block extrahead %}
    {{ block.super }}
    <script defer src="{% static 'admin/js/appointments.js' %}"></script>
    <!-- <link rel="stylesheet" href="{% static 'admin/css/custom_sidebar.css' %}">
    <script defer src="{% static 'admin/js/custom_sidebar.js' %}"></script> -->
{% endblock %}
{% block extrastyle %}
    {{ block.super }}
    <link rel="stylesheet" href="{% static 'admin/css/appointments.css' %}">
{% endblock %}
{% block content %}
    <div class="calendar-shell">
        <div class="calendar-nav">
            <div class="calendar-left">
                <button class="nav-btn" onclick="changeDateToToday()">Today</button>

                <div class="nav-group">
                    <button class="nav-icon2" onclick="changeDateByDays(-1)">&lt;</button>
                    <div class="fake-date-picker" onclick="document.getElementById('realDateInput').showPicker()">
                        <span id="displayDate">{{ selected_date|date:"Y-m-d" }}</span>
                        <input
                                type="date"
                                id="realDateInput"
                                value="{{ selected_date|date:'Y-m-d' }}"
                                onchange="onDateChange(this.value)"
                        />
                    </div>
                    <button class="nav-icon2" onclick="changeDateByDays(1)">&gt;</button>
                </div>

                <div class="view-toggle" role="tablist" aria-label="Calendar view">
                    <button type="button" class="view-btn {% if calendar_view == 'day' %}active{% endif %}" data-view="day" onclick="setCalendarView('day')">Day</button>
                    <button type="button" class="view-btn {% if calendar_view == 'week' %}active{% endif %}" data-view="week" onclick="setCalendarView('week')">Week</button>
                    <button type="button" class="view-btn {% if calendar_view == 'month' %}active{% endif %}" data-view="month" onclick="setCalendarView('month')">Month</button>
                </div>

                <button class="nav-icon2" id="nav-icon2" style="border-radius: 10px;">
                    <img src="https://img.icons8.com/?size=100&id=O7hGF9n2ssaW&format=png&color=000000"
                         alt="Filter" style="width: 2.2vh; height: 2.2vh;">
                </button>
            </div>

            <div class="calendar-right">
                <div class="add-dropdown">
                    <button id="addDropdownBtn" class="add-appointment-btn">Add <span id="arrow">â–¾</span></button>
                    <div id="addDropdownMenu" class="add-dropdown-menu hidden">
                        <a href="#" onclick="handleAdd('appointment')">ğŸ“… Appointment</a>

                        <a href="#" onclick="handleAdd('vacation')">âŒ Blocked time</a>

                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Sidebar -->
    <div id="filterSidebar" class="sidebar2 hidden">
        <div class="sidebar-header2">
            <h3>All filters</h3>
            <button class="close-btn2" onclick="closeSidebar()">âœ•</button>
        </div>


        <form id="filterForm">
            <div class="filter-section">
                <div class="filter-header" onclick="toggleSection(this)">
                    ğŸ“… Appointment status <span class="arrow">âŒ„</span>
                </div>
                <div class="filter-content">
                    {% for status in appointment_statuses %}
                        <label class="checkbox-wrapper">
                            <input type="checkbox" name="status" value="{{ status.id }}">
                            <span>{{ status.name }}</span>
                        </label>
                    {% endfor %}
                </div>
            </div>

            <div class="filter-section">
                <div class="filter-header" onclick="toggleSection(this)">
                    ğŸ’³ Payment status <span class="arrow">âŒ„</span>
                </div>
                <div class="filter-content">
                    {% for ps in payment_statuses %}
                        <label class="checkbox-wrapper">
                            <input type="checkbox" name="payment_status" value="{{ ps.id }}">
                            <span>{{ ps.name }}</span>
                        </label>
                    {% endfor %}
                </div>
            </div>

            <div class="filter-section">
                <div class="filter-header" onclick="toggleSection(this)">
                    ğŸ·ï¸ Services <span class="arrow">Edit</span>
                </div>
                <div class="filter-content">
                    <select name="service" id="serviceSelect">
                        <option value="">All</option>
                        {% for service in services %}
                            <option value="{{ service.id }}">{{ service.name }}</option>
                        {% endfor %}
                    </select>
                </div>
            </div>

            <div class="filter-footer">
                <button type="submit" class="apply-btn">Apply filters</button>
                <button type="button" onclick="clearAllFilters()" class="clear-btn">Clear filters</button>
            </div>
        </form>
    </div>
    <div id="calendar-container">
        {% include "admin/appointments_calendar_partial.html" %}
    </div>
    <input type="hidden" id="calendarView" value="{{ calendar_view|default:'week' }}">
    <div id="addPopup" class="popup hidden">
        <div class="popup-header">
            <span id="popupTime">Time</span>
            <button class="popup-close" onclick="closePopup()">âœ•</button>
        </div>
        <div class="popup-body">
        </div>
    </div>
    <div id="apptTooltip" class="appt-tooltip hidden"></div>

{% endblock %}
